// Prisma schema for Fieldly PIM

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id             String   @id @default(uuid())
  email          String?  @unique
  password       String
  name           String
  phone          String?  @unique
  farmName       String
  profilePicture String?
  refreshToken   String?
  otp            String?
  otpExpiresAt   DateTime?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  animals        Animal[]

  @@map("users")
}

model Animal {
  id             String   @id @default(uuid())
  nodeId         String   @unique
  farmerId       String
  farmer         User     @relation(fields: [farmerId], references: [id])
  name           String
  animalType     String   // COW, SHEEP, HORSE, DOG
  breed          String?
  age            Int      // months
  ageYears       Int      @default(0)
  sex            String   // MALE, FEMALE
  weight         Float?
  color          String?
  healthStatus   String   @default("OPTIMAL") // OPTIMAL, WARNING, CRITICAL
  vitalityScore  Int      @default(100)
  bodyTemp       Float?
  activityLevel  String   @default("MODERATE") // LOW, MODERATE, HIGH
  lastVetCheck   DateTime?
  vaccination    Boolean  @default(false)
  milkYield      Float?
  woolYield      Float?
  isPregnant     Boolean?
  lastInseminationDate DateTime?
  lastBirthDate  DateTime?
  role           String?   // GUARD, SHEPHERD (for DOG)
  fatContent     Float?
  protein        Float?
  feedIntakeRecorded DateTime?
  dewormingScheduled DateTime?
  profileImage   String?
  tagNumber      String?
  notes          String?
  productionHabit String? // ACTIVE, NORMAL, LESS
  vaccines       Json? // List of { name: string, date: string }
  birthHistory   Json? // List of { date: string, weight: float, health: string }
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("animals")
}

